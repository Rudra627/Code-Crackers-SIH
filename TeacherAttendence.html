<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Teacher Attendance</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #fffbe7;
      color: #37304a;
    }
    .container {
      max-width: 960px;
      margin: 36px auto;
      background: #fff9ea;
      border-radius: 18px;
      box-shadow: 0 8px 32px -12px #ff962f44;
      padding: 38px 22px;
    }
    h2 {
      color: #23212b;
      font-size: 2em;
      margin-top: 0;
      margin-bottom: 15px;
    }
    .form-row {
      display: flex;
      gap: 18px;
      flex-wrap: wrap;
      margin-bottom: 22px;
    }
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
      min-width: 160px;
      margin-bottom: 10px;
    }
    .form-group label {
      font-size: 1em;
      color: #ff962f;
      font-weight: 500;
    }
    .form-group input, .form-group select {
      padding: 7px 12px;
      border: none;
      border-radius: 7px;
      background: #fff;
      font-size: 1.08em;
      box-shadow: 0 2px 8px -8px #ff962f44;
      outline: none;
      transition: box-shadow .2s;
    }
    .form-group input:focus, .form-group select:focus {
      box-shadow: 0 2px 16px -8px #ff962f88;
      border: 1px solid #ff962f;
    }
    .btn-row {
      display: flex;
      gap: 16px;
      margin-bottom: 20px;
      align-items: center;
    }
    .btn {
      padding: 10px 26px;
      background: #ff962f;
      color: #fff;
      border: none;
      border-radius: 9px;
      font-size: 1.1em;
      font-weight: 600;
      box-shadow: 0 4px 18px -8px #ff962f50;
      cursor: pointer;
      transition: background 0.2s;
    }
    .btn:disabled {
      background: #ffdcb6;
      color: #aaa;
      cursor: not-allowed;
    }
    .info {
      font-size: 1.11em;
      color: #23212b;
      margin-left: 12px;
    }
    .attendance-table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 12px rgba(55,48,74,0.08);
      overflow: hidden;
      margin-bottom: 24px;
    }
    .attendance-table th, .attendance-table td {
      padding: 13px 10px;
      text-align: left;
      font-size: 1em;
    }
    .attendance-table thead {
      background: #ffe6c2;
      color: #37304a;
    }
    .attendance-table tbody tr:nth-child(even) {
      background: #fffbe7;
    }
    .present {
      color: #4caf50;
      font-weight: 700;
    }
    .absent {
      color: #e74c3c;
      font-weight: 700;
    }

    @media (max-width: 700px) {
      .container { padding: 12px 2vw;}
      .form-row { flex-direction: column; gap: 10px;}
      .attendance-table th, .attendance-table td { font-size: 0.95em; }
      h2 { font-size: 1.35em;}
    }
  </style>
</head>
<body>
<div class="container">
  <h2>Take Attendance</h2>
  <form id="attendanceForm">
    <div class="form-row">
      <div class="form-group">
        <label for="class">Select Class</label>
        <select id="class" required>
          <option value="">Choose...</option>
          <option value="CS - 4th Year">CS - 4th Year</option>
          <option value="IT - 3rd Year">IT - 3rd Year</option>
          <option value="ECE - 2nd Year">ECE - 2nd Year</option>
        </select>
      </div>
      <div class="form-group">
        <label for="startTime">Start Time</label>
        <input type="time" id="startTime" required>
      </div>
      <div class="form-group">
        <label for="endTime">End Time</label>
        <input type="time" id="endTime" required>
      </div>
      <div class="form-group">
        <label for="date">Date</label>
        <input type="date" id="date" required>
      </div>
    </div>
    <div class="btn-row">
      <button type="button" class="btn" id="startAttendance">Start Attendance</button>
      <span class="info" id="timerInfo"></span>
    </div>
    <div class="form-row" style="align-items: center;">
      <div class="form-group">
        <label for="barcode">Student Barcode / Roll No</label>
        <input type="text" id="barcode" placeholder="Enter barcode or roll no...">
      </div>
      <button type="button" class="btn" id="addStudent">Add</button>
    </div>
  </form>
  <table class="attendance-table">
    <thead>
      <tr>
        <th>Roll No</th>
        <th>Name</th>
        <th>Class</th>
        <th>Arrival Time</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody id="attendanceList"></tbody>
  </table>
</div>
<script>
  // Example student data (barcode = rollNo)
  const studentRecords = {
    "CS22001": { name: "Mohit Sharma", class: "CS - 4th Year" },
    "CS22002": { name: "Priya Singh", class: "CS - 4th Year" },
    "IT33001": { name: "Rahul Kumar", class: "IT - 3rd Year" },
    "ECE21001": { name: "Sonal Gupta", class: "ECE - 2nd Year" }
  };

  let attendanceActive = false;
  let timerInterval = null;
  let attendanceList = [];

  document.getElementById('startAttendance').onclick = function() {
    if (!document.getElementById('class').value || !document.getElementById('startTime').value || !document.getElementById('endTime').value || !document.getElementById('date').value) {
      alert('Please fill all class details.');
      return;
    }
    attendanceActive = true;
    attendanceList = [];
    renderAttendanceTable();
    startTimer();
    this.disabled = true;
  };

  // Adding student by barcode
  document.getElementById('addStudent').onclick = function() {
    if (!attendanceActive) {
      alert('Start attendance first!');
      return;
    }
    const barcode = document.getElementById('barcode').value.trim();
    if (!barcode) return;
    if (!studentRecords[barcode]) {
      alert('Student not found!');
      return;
    }
    // Check if already added
    if (attendanceList.some(s => s.rollNo === barcode)) {
      alert('Already marked!');
      return;
    }
    const now = new Date();
    const arrival = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');
    attendanceList.push({
      rollNo: barcode,
      name: studentRecords[barcode].name,
      class: studentRecords[barcode].class,
      arrival: arrival,
      status: 'Present'
    });
    document.getElementById('barcode').value = '';
    renderAttendanceTable();
  };

  function renderAttendanceTable() {
    document.getElementById('attendanceList').innerHTML = attendanceList.map(rec =>
      `<tr>
        <td>${rec.rollNo}</td>
        <td>${rec.name}</td>
        <td>${rec.class}</td>
        <td>${rec.arrival}</td>
        <td class="present">${rec.status}</td>
      </tr>`
    ).join('');
  }

  // Timer logic
  function startTimer() {
    const startTimeStr = document.getElementById('startTime').value;
    const endTimeStr = document.getElementById('endTime').value;
    if (!startTimeStr || !endTimeStr) return;
    const now = new Date();
    let endTime = new Date(now.toDateString() + ' ' + endTimeStr);
    // If endTime has already passed today, add 1 day
    if (endTime < now) endTime.setDate(now.getDate() + 1);
    timerInterval = setInterval(function() {
      const now = new Date();
      let diff = Math.max(0, endTime - now);
      let hrs = Math.floor(diff / 3600000);
      let min = Math.floor((diff % 3600000) / 60000);
      let sec = Math.floor((diff % 60000) / 1000);
      document.getElementById('timerInfo').textContent = `Time Remaining: ${hrs.toString().padStart(2,'0')}:${min.toString().padStart(2,'0')}:${sec.toString().padStart(2,'0')}`;
      if (diff <= 0) {
        document.getElementById('timerInfo').textContent = 'Attendance period ended.';
        attendanceActive = false;
        clearInterval(timerInterval);
        document.getElementById('startAttendance').disabled = false;
      }
    }, 1000);
  }
</script>
</body>
</html>
